# 실제 브라우저 테스트 실행 가이드

## 🚀 빠른 테스트 시작

서버가 이미 실행되어 있다고 하셨으므로, 다음 순서로 테스트를 진행하세요:

### 1️⃣ BOM 중복 항목 합산 테스트

```javascript
// 브라우저 콘솔에서 실행
(async () => {
  const response = await fetch('/api/bom?limit=500');
  const data = await response.json();
  
  console.log('=== BOM 중복 항목 합산 검증 ===');
  console.log('총 BOM 항목 수:', data.data?.bom_entries?.length);
  
  // 중복 확인
  const keyCount = new Map();
  data.data?.bom_entries?.forEach(item => {
    const key = `${item.parent_item_id}-${item.child_item_id}-${item.customer?.company_id || 'null'}-${item.child_supplier?.company_id || 'null'}`;
    keyCount.set(key, (keyCount.get(key) || 0) + 1);
  });
  
  const duplicates = Array.from(keyCount.entries()).filter(([k, v]) => v > 1);
  console.log('중복된 조합:', duplicates.length, '개');
  
  if (duplicates.length === 0) {
    console.log('✅ 중복이 없습니다 - 합산 로직이 정상 작동 중');
  } else {
    console.warn('⚠️ 중복이 발견되었습니다:', duplicates);
  }
})();
```

### 2️⃣ 프레스 용량 선택 테스트

1. 브라우저에서 접속: `http://localhost:3000/inventory?tab=production`
2. "생산 등록" 버튼 클릭
3. "공정 구분" → "프레스" 체크
4. "프레스 용량" 드롭다운 클릭
5. 콘솔 확인:
   - `[ProductionEntryForm] 프레스 용량 선택: [값]` 로그 확인
   - 드롭다운이 정상 표시되는지 확인

### 3️⃣ Companies API 필터 테스트

```javascript
// 브라우저 콘솔에서 실행
(async () => {
  console.log('=== Companies API 필터 검증 ===');
  
  const [customerRes, supplierRes, allRes] = await Promise.all([
    fetch('/api/companies?type=CUSTOMER').then(r => r.json()),
    fetch('/api/companies?type=SUPPLIER').then(r => r.json()),
    fetch('/api/companies').then(r => r.json())
  ]);
  
  const customers = customerRes.data?.data || [];
  const suppliers = supplierRes.data?.data || [];
  const all = allRes.data?.data || [];
  
  console.log('CUSTOMER 필터 결과:', customers.length, '개');
  console.log('SUPPLIER 필터 결과:', suppliers.length, '개');
  console.log('전체 결과:', all.length, '개');
  
  // 타입 검증
  const customerTypes = [...new Set(customers.map(c => c.company_type))];
  const supplierTypes = [...new Set(suppliers.map(c => c.company_type))];
  
  console.log('CUSTOMER 필터 타입:', customerTypes);
  console.log('SUPPLIER 필터 타입:', supplierTypes);
  
  if (customerTypes.length === 1 && customerTypes[0] === '고객사') {
    console.log('✅ CUSTOMER 필터 정상 작동');
  } else {
    console.error('❌ CUSTOMER 필터 오류:', customerTypes);
  }
  
  if (supplierTypes.every(t => ['공급사', '협력사'].includes(t))) {
    console.log('✅ SUPPLIER 필터 정상 작동');
  } else {
    console.error('❌ SUPPLIER 필터 오류:', supplierTypes);
  }
})();
```

### 4️⃣ Companies Options API 테스트

```javascript
// 브라우저 콘솔에서 실행
(async () => {
  console.log('=== Companies Options API 검증 ===');
  
  const [customerRes, supplierRes, allRes] = await Promise.all([
    fetch('/api/companies/options?type=CUSTOMER').then(r => r.json()),
    fetch('/api/companies/options?type=SUPPLIER').then(r => r.json()),
    fetch('/api/companies/options').then(r => r.json())
  ]);
  
  console.log('CUSTOMER 옵션:', customerRes.data?.data?.length, '개');
  console.log('SUPPLIER 옵션:', supplierRes.data?.data?.length, '개');
  console.log('전체 옵션:', allRes.data?.data?.length, '개');
  
  if (customerRes.success && supplierRes.success && allRes.success) {
    console.log('✅ 모든 API 요청 성공');
  } else {
    console.error('❌ API 요청 실패');
  }
})();
```

### 5️⃣ BOM 페이지 순환 참조 테스트

1. 브라우저에서 접속: `http://localhost:3000/master/bom`
2. 개발자 도구 → 콘솔 탭 열기
3. 에러 메시지 확인:
   - "Maximum update depth exceeded" 같은 순환 참조 에러가 없는지 확인
4. 네트워크 탭 확인:
   - 무한 반복되는 요청이 없는지 확인
5. 페이지 로딩 시간 확인:
   - 5초 이상 걸리면 문제 가능성

---

## 📝 테스트 결과 기록

테스트 후 아래 항목을 체크하세요:

- [ ] BOM 중복 항목 합산 정상 작동
- [ ] 프레스 용량 드롭다운 정상 작동 (z-index 해결)
- [ ] Companies API CUSTOMER 필터 정상 작동
- [ ] Companies Options API type 파라미터 정상 작동
- [ ] BOM 페이지 순환 참조 문제 해결
- [ ] 콘솔 에러 없음
- [ ] 네트워크 요청 정상

---

## 🐛 문제 발견 시

문제가 발견되면 다음 정보를 기록해주세요:

1. **문제 설명**
2. **재현 단계**
3. **예상 동작**
4. **실제 동작**
5. **콘솔 에러 메시지**
6. **스크린샷 (가능하면)**

이 정보를 주시면 빠르게 해결할 수 있습니다!

